<div class="product-row text-left border shadow-2xl border-gray-600 p-4 sm:p-5 rounded-lg space-y-4"
     id="prod{{ product.pk }}">

    <!-- Header -->
    <element id="header"
             class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 border-b border-gray-600 pb-3">
        <h1 class="font-semibold">{{ product }}</h1>

        <p class="text-sm">
            Prix de vente: {{ product.price }}
            <input type="hidden" value="{{ product.price }}" name="sale_price[]">
        </p>

        <button type="button"
                class="self-end sm:self-auto text-red-500"
                style="height: 30px;"
                onclick="this.closest('div').remove(); updateAddButton()">
            ❌
        </button>
    </element>

    <!-- Prix & Quantité -->
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">

        <div class="flex flex-col gap-1">
            <label for="product_price">Prix d'achat unitaire</label>
            <div class="flex items-center gap-2">
                <input autofocus
                       id="product_price"
                       type="number"
                       name="unit_cost[]"
                       min="0.00"
                       step="0.01"
                       value="0.00"
                       required
                       class="h-9 px-3 py-2 border border-gray-500 rounded-md
                              focus:outline-none focus:border-2 focus:border-green-600
                              dark:bg-gray-800 dark:border-gray-600 dark:text-white w-full"
                       onkeyup="
                           const row0 = this.closest('.product-row');
                           row0.querySelector('#paid_amount').value =
                           (this.value * row0.querySelector('#quantity').value).toFixed(2);
                       "
                       onchange="
                           const row1 = this.closest('.product-row');
                           row1.querySelector('#paid_amount').value =
                           (this.value * row1.querySelector('#quantity').value).toFixed(2);
                       ">
                <span>$</span>
            </div>
        </div>

        <div class="flex flex-col gap-1">
            <label for="quantity">Quantité</label>
            <input type="number"
                   name="quantity[]"
                   min="1"
                   id="quantity"
                   value="1"
                   class="h-9 px-3 py-2 border border-gray-500 rounded-md
                          focus:outline-none focus:border-2 focus:border-green-600
                          dark:bg-gray-800 dark:border-gray-600 dark:text-white w-full"
                   onchange="
                       const row2 = this.closest('.product-row');
                       row2.querySelector('#paid_amount').value =
                       (this.value * row2.querySelector('#product_price').value).toFixed(2);
                   "
                   onkeyup="
                       const row3 = this.closest('.product-row');
                       row3.querySelector('#paid_amount').value =
                       (this.value * row3.querySelector('#product_price').value).toFixed(2);
                   ">
        </div>

    </div>

    <!-- Paiement -->
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">

        <div class="flex flex-col gap-1">
            <label for="paid_amount">Montant payé</label>
            <div class="flex items-center gap-2">
                <input id="paid_amount"
                       type="number"
                       step="0.01"
                       name="paidAmount[]"
                       min="0"
                       placeholder="0.00"
                       value="0.00"
                       class="h-9 px-3 py-2 border border-gray-500 rounded-md
                              focus:outline-none focus:border-2 focus:border-green-600
                              dark:bg-gray-800 dark:border-gray-600 dark:text-white w-full"
                       onkeyup="
                           const row4 = this.closest('.product-row');
                           if (this.value >
                               (row4.querySelector('#product_price').value *
                                row4.querySelector('#quantity').value)) {
                               this.value =
                               (row4.querySelector('#product_price').value *
                                row4.querySelector('#quantity').value).toFixed(2);
                           }
                           row4.querySelector('#leftover_amount').value =
                           ((row4.querySelector('#product_price').value *
                             row4.querySelector('#quantity').value) - this.value).toFixed(2);
                       "
                       onchange="
                           const row5 = this.closest('.product-row');
                           if (this.value >
                               (row5.querySelector('#product_price').value *
                                row5.querySelector('#quantity').value)) {
                               this.value =
                               (row5.querySelector('#product_price').value *
                                row5.querySelector('#quantity').value).toFixed(2);
                           }
                           row5.querySelector('#leftover_amount').value =
                           ((row5.querySelector('#product_price').value *
                             row5.querySelector('#quantity').value) - this.value).toFixed(2);
                       ">
                <span>$</span>
            </div>
        </div>

        <div class="flex flex-col gap-1">
            <label for="leftover_amount">Montant restant</label>
            <div class="flex items-center gap-2">
                <input id="leftover_amount"
                       type="number"
                       name="leftOver"
                       step="0.01"
                       min="0"
                       value="0.00"
                       readonly
                       class="h-9 px-3 py-2 border border-gray-500 rounded-md
                              dark:bg-gray-800 dark:border-gray-600 dark:text-white w-full">
                <span>$</span>
            </div>
        </div>

    </div>

    <input type="hidden" name="product_id[]" value="{{ product.pk }}">

</div>

